<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Activity 10 RNA-seq | EBIO4100: Bioinformatics in the Mountains</title>
  <meta name="description" content="This bookdown organizes the course materials for EBIO4100: Intro to Bioinformatics, taught Summer 2025." />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Activity 10 RNA-seq | EBIO4100: Bioinformatics in the Mountains" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/logo_hagar.JPG" />
  <meta property="og:description" content="This bookdown organizes the course materials for EBIO4100: Intro to Bioinformatics, taught Summer 2025." />
  <meta name="github-repo" content="mfrayer/bioinformatics_in_the_mountains" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Activity 10 RNA-seq | EBIO4100: Bioinformatics in the Mountains" />
  
  <meta name="twitter:description" content="This bookdown organizes the course materials for EBIO4100: Intro to Bioinformatics, taught Summer 2025." />
  <meta name="twitter:image" content="/images/logo_hagar.JPG" />

<meta name="author" content="Megan Frayer" />


<meta name="date" content="2025-07-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="blast-and-genome-browser.html"/>
<link rel="next" href="extras.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">EBIO4100: Bioinformatics in the Mountains</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="welcome-to-ebio4100-bioinformatics-in-the-mountains.html"><a href="welcome-to-ebio4100-bioinformatics-in-the-mountains.html"><i class="fa fa-check"></i>Welcome to EBIO4100: Bioinformatics in the Mountains!</a>
<ul>
<li class="chapter" data-level="0.1" data-path="welcome-to-ebio4100-bioinformatics-in-the-mountains.html"><a href="welcome-to-ebio4100-bioinformatics-in-the-mountains.html#how-to-use-this-ebook"><i class="fa fa-check"></i><b>0.1</b> How to use this ebook</a></li>
<li class="chapter" data-level="0.2" data-path="welcome-to-ebio4100-bioinformatics-in-the-mountains.html"><a href="welcome-to-ebio4100-bioinformatics-in-the-mountains.html#goalslearning-objectives"><i class="fa fa-check"></i><b>0.2</b> Goals/Learning Objectives</a></li>
<li class="chapter" data-level="0.3" data-path="welcome-to-ebio4100-bioinformatics-in-the-mountains.html"><a href="welcome-to-ebio4100-bioinformatics-in-the-mountains.html#how-to-succeed-in-this-course"><i class="fa fa-check"></i><b>0.3</b> How to succeed in this course:</a></li>
<li class="chapter" data-level="0.4" data-path="welcome-to-ebio4100-bioinformatics-in-the-mountains.html"><a href="welcome-to-ebio4100-bioinformatics-in-the-mountains.html#important-links"><i class="fa fa-check"></i><b>0.4</b> Important Links</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="computer-set-up-and-introduction-to-the-command-line.html"><a href="computer-set-up-and-introduction-to-the-command-line.html"><i class="fa fa-check"></i><b>1</b> Computer set up and Introduction to the command line</a>
<ul>
<li class="chapter" data-level="1.1" data-path="computer-set-up-and-introduction-to-the-command-line.html"><a href="computer-set-up-and-introduction-to-the-command-line.html#get-oriented-to-the-cluster"><i class="fa fa-check"></i><b>1.1</b> Get oriented to the cluster</a></li>
<li class="chapter" data-level="1.2" data-path="computer-set-up-and-introduction-to-the-command-line.html"><a href="computer-set-up-and-introduction-to-the-command-line.html#first-command"><i class="fa fa-check"></i><b>1.2</b> First command</a></li>
<li class="chapter" data-level="1.3" data-path="computer-set-up-and-introduction-to-the-command-line.html"><a href="computer-set-up-and-introduction-to-the-command-line.html#how-to-navigate-a-file-system"><i class="fa fa-check"></i><b>1.3</b> How to navigate a file system</a></li>
<li class="chapter" data-level="1.4" data-path="computer-set-up-and-introduction-to-the-command-line.html"><a href="computer-set-up-and-introduction-to-the-command-line.html#basic-file-manipulation"><i class="fa fa-check"></i><b>1.4</b> Basic file manipulation</a></li>
<li class="chapter" data-level="1.5" data-path="computer-set-up-and-introduction-to-the-command-line.html"><a href="computer-set-up-and-introduction-to-the-command-line.html#assignment"><i class="fa fa-check"></i><b>1.5</b> Assignment</a></li>
<li class="chapter" data-level="1.6" data-path="computer-set-up-and-introduction-to-the-command-line.html"><a href="computer-set-up-and-introduction-to-the-command-line.html#if-we-have-extra-time"><i class="fa fa-check"></i><b>1.6</b> If we have extra timeâ€¦</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="fasta-files-and-visual-alignment-with-mafft.html"><a href="fasta-files-and-visual-alignment-with-mafft.html"><i class="fa fa-check"></i><b>2</b> FASTA files and visual alignment with MAFFT</a>
<ul>
<li class="chapter" data-level="2.1" data-path="fasta-files-and-visual-alignment-with-mafft.html"><a href="fasta-files-and-visual-alignment-with-mafft.html#exploring-a-fasta-file"><i class="fa fa-check"></i><b>2.1</b> Exploring a fasta file</a></li>
<li class="chapter" data-level="2.2" data-path="fasta-files-and-visual-alignment-with-mafft.html"><a href="fasta-files-and-visual-alignment-with-mafft.html#visual-alignment"><i class="fa fa-check"></i><b>2.2</b> Visual Alignment</a></li>
<li class="chapter" data-level="2.3" data-path="fasta-files-and-visual-alignment-with-mafft.html"><a href="fasta-files-and-visual-alignment-with-mafft.html#mafft-multiple-sequence-alignment"><i class="fa fa-check"></i><b>2.3</b> MAFFT Multiple Sequence Alignment</a></li>
<li class="chapter" data-level="2.4" data-path="fasta-files-and-visual-alignment-with-mafft.html"><a href="fasta-files-and-visual-alignment-with-mafft.html#assignment-1"><i class="fa fa-check"></i><b>2.4</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="alignment-of-whole-genome-data.html"><a href="alignment-of-whole-genome-data.html"><i class="fa fa-check"></i><b>3</b> Alignment of whole genome data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="alignment-of-whole-genome-data.html"><a href="alignment-of-whole-genome-data.html#environmental-variables"><i class="fa fa-check"></i><b>3.1</b> Environmental variables</a></li>
<li class="chapter" data-level="3.2" data-path="alignment-of-whole-genome-data.html"><a href="alignment-of-whole-genome-data.html#explore-the-sequencing-data-and-reference-genome"><i class="fa fa-check"></i><b>3.2</b> Explore the sequencing data and reference genome</a></li>
<li class="chapter" data-level="3.3" data-path="alignment-of-whole-genome-data.html"><a href="alignment-of-whole-genome-data.html#fastqc"><i class="fa fa-check"></i><b>3.3</b> FASTQC</a></li>
<li class="chapter" data-level="3.4" data-path="alignment-of-whole-genome-data.html"><a href="alignment-of-whole-genome-data.html#trimming"><i class="fa fa-check"></i><b>3.4</b> Trimming</a></li>
<li class="chapter" data-level="3.5" data-path="alignment-of-whole-genome-data.html"><a href="alignment-of-whole-genome-data.html#alignment-with-bwa"><i class="fa fa-check"></i><b>3.5</b> Alignment with BWA</a></li>
<li class="chapter" data-level="3.6" data-path="alignment-of-whole-genome-data.html"><a href="alignment-of-whole-genome-data.html#read-groups"><i class="fa fa-check"></i><b>3.6</b> Read Groups</a></li>
<li class="chapter" data-level="3.7" data-path="alignment-of-whole-genome-data.html"><a href="alignment-of-whole-genome-data.html#how-good-was-our-alignment"><i class="fa fa-check"></i><b>3.7</b> How good was our alignment?</a></li>
<li class="chapter" data-level="3.8" data-path="alignment-of-whole-genome-data.html"><a href="alignment-of-whole-genome-data.html#assignment-2"><i class="fa fa-check"></i><b>3.8</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="variant-calling.html"><a href="variant-calling.html"><i class="fa fa-check"></i><b>4</b> Variant calling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="variant-calling.html"><a href="variant-calling.html#remove-duplicates-from-the-bam-file"><i class="fa fa-check"></i><b>4.1</b> Remove duplicates from the BAM file</a></li>
<li class="chapter" data-level="4.2" data-path="variant-calling.html"><a href="variant-calling.html#call-variants-with-gatk"><i class="fa fa-check"></i><b>4.2</b> Call Variants with GATK</a></li>
<li class="chapter" data-level="4.3" data-path="variant-calling.html"><a href="variant-calling.html#call-variants-with-bcftools"><i class="fa fa-check"></i><b>4.3</b> Call variants with bcftools</a></li>
<li class="chapter" data-level="4.4" data-path="variant-calling.html"><a href="variant-calling.html#are-they-all-the-same"><i class="fa fa-check"></i><b>4.4</b> Are they all the same?</a></li>
<li class="chapter" data-level="4.5" data-path="variant-calling.html"><a href="variant-calling.html#assignment-3"><i class="fa fa-check"></i><b>4.5</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="variant-filtering.html"><a href="variant-filtering.html"><i class="fa fa-check"></i><b>5</b> Variant filtering</a>
<ul>
<li class="chapter" data-level="5.1" data-path="variant-filtering.html"><a href="variant-filtering.html#introduction-to-bcftools"><i class="fa fa-check"></i><b>5.1</b> Introduction to BCFtools</a></li>
<li class="chapter" data-level="5.2" data-path="variant-filtering.html"><a href="variant-filtering.html#filter-for-quality"><i class="fa fa-check"></i><b>5.2</b> Filter for quality</a></li>
<li class="chapter" data-level="5.3" data-path="variant-filtering.html"><a href="variant-filtering.html#filter-for-biallelic-snps"><i class="fa fa-check"></i><b>5.3</b> Filter for biallelic SNPs</a></li>
<li class="chapter" data-level="5.4" data-path="variant-filtering.html"><a href="variant-filtering.html#filter-for-frequency"><i class="fa fa-check"></i><b>5.4</b> Filter for frequency</a></li>
<li class="chapter" data-level="5.5" data-path="variant-filtering.html"><a href="variant-filtering.html#bcftools-query"><i class="fa fa-check"></i><b>5.5</b> bcftools query</a></li>
<li class="chapter" data-level="5.6" data-path="variant-filtering.html"><a href="variant-filtering.html#assignment-4"><i class="fa fa-check"></i><b>5.6</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="basic-phylogenetics.html"><a href="basic-phylogenetics.html"><i class="fa fa-check"></i><b>6</b> Basic Phylogenetics</a>
<ul>
<li class="chapter" data-level="6.1" data-path="basic-phylogenetics.html"><a href="basic-phylogenetics.html#upgma-tree"><i class="fa fa-check"></i><b>6.1</b> UPGMA Tree</a></li>
<li class="chapter" data-level="6.2" data-path="basic-phylogenetics.html"><a href="basic-phylogenetics.html#mafft"><i class="fa fa-check"></i><b>6.2</b> MAFFT</a></li>
<li class="chapter" data-level="6.3" data-path="basic-phylogenetics.html"><a href="basic-phylogenetics.html#iq-tree"><i class="fa fa-check"></i><b>6.3</b> IQ-TREE</a></li>
<li class="chapter" data-level="6.4" data-path="basic-phylogenetics.html"><a href="basic-phylogenetics.html#assignment-5"><i class="fa fa-check"></i><b>6.4</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="annotation.html"><a href="annotation.html"><i class="fa fa-check"></i><b>7</b> Annotation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="annotation.html"><a href="annotation.html#find-features-in-a-sequence"><i class="fa fa-check"></i><b>7.1</b> Find features in a sequence</a></li>
<li class="chapter" data-level="7.2" data-path="annotation.html"><a href="annotation.html#intro-to-bedtools"><i class="fa fa-check"></i><b>7.2</b> Intro to BEDtools</a></li>
<li class="chapter" data-level="7.3" data-path="annotation.html"><a href="annotation.html#gene-ontology"><i class="fa fa-check"></i><b>7.3</b> Gene Ontology</a></li>
<li class="chapter" data-level="7.4" data-path="annotation.html"><a href="annotation.html#assignment-6"><i class="fa fa-check"></i><b>7.4</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="reproducibility.html"><a href="reproducibility.html"><i class="fa fa-check"></i><b>8</b> Reproducibility</a>
<ul>
<li class="chapter" data-level="8.1" data-path="reproducibility.html"><a href="reproducibility.html#how-do-you-draw-shapes"><i class="fa fa-check"></i><b>8.1</b> How do you draw shapes?</a></li>
<li class="chapter" data-level="8.2" data-path="reproducibility.html"><a href="reproducibility.html#practice-annotating-code"><i class="fa fa-check"></i><b>8.2</b> Practice annotating code</a></li>
<li class="chapter" data-level="8.3" data-path="reproducibility.html"><a href="reproducibility.html#version-control-software"><i class="fa fa-check"></i><b>8.3</b> Version Control Software</a></li>
<li class="chapter" data-level="8.4" data-path="reproducibility.html"><a href="reproducibility.html#explore-github"><i class="fa fa-check"></i><b>8.4</b> Explore github</a></li>
<li class="chapter" data-level="8.5" data-path="reproducibility.html"><a href="reproducibility.html#assignment-7"><i class="fa fa-check"></i><b>8.5</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="blast-and-genome-browser.html"><a href="blast-and-genome-browser.html"><i class="fa fa-check"></i><b>9</b> BLAST and Genome Browser</a>
<ul>
<li class="chapter" data-level="9.1" data-path="blast-and-genome-browser.html"><a href="blast-and-genome-browser.html#ncbi-databases"><i class="fa fa-check"></i><b>9.1</b> NCBI Databases</a></li>
<li class="chapter" data-level="9.2" data-path="blast-and-genome-browser.html"><a href="blast-and-genome-browser.html#blast"><i class="fa fa-check"></i><b>9.2</b> BLAST</a></li>
<li class="chapter" data-level="9.3" data-path="blast-and-genome-browser.html"><a href="blast-and-genome-browser.html#genome-browser"><i class="fa fa-check"></i><b>9.3</b> Genome Browser</a></li>
<li class="chapter" data-level="9.4" data-path="blast-and-genome-browser.html"><a href="blast-and-genome-browser.html#download-data-from-ncbi"><i class="fa fa-check"></i><b>9.4</b> Download Data from NCBI</a></li>
<li class="chapter" data-level="9.5" data-path="blast-and-genome-browser.html"><a href="blast-and-genome-browser.html#assignment-8"><i class="fa fa-check"></i><b>9.5</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="rna-seq.html"><a href="rna-seq.html"><i class="fa fa-check"></i><b>10</b> RNA-seq</a>
<ul>
<li class="chapter" data-level="10.1" data-path="rna-seq.html"><a href="rna-seq.html#processing-the-data"><i class="fa fa-check"></i><b>10.1</b> Processing the data</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="rna-seq.html"><a href="rna-seq.html#quality-control"><i class="fa fa-check"></i><b>10.1.1</b> Quality Control</a></li>
<li class="chapter" data-level="10.1.2" data-path="rna-seq.html"><a href="rna-seq.html#trimming-1"><i class="fa fa-check"></i><b>10.1.2</b> Trimming</a></li>
<li class="chapter" data-level="10.1.3" data-path="rna-seq.html"><a href="rna-seq.html#alignment"><i class="fa fa-check"></i><b>10.1.3</b> Alignment</a></li>
<li class="chapter" data-level="10.1.4" data-path="rna-seq.html"><a href="rna-seq.html#remove-duplicates"><i class="fa fa-check"></i><b>10.1.4</b> Remove duplicates</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="rna-seq.html"><a href="rna-seq.html#differential-expression"><i class="fa fa-check"></i><b>10.2</b> Differential expression</a></li>
<li class="chapter" data-level="10.3" data-path="rna-seq.html"><a href="rna-seq.html#assignment-9"><i class="fa fa-check"></i><b>10.3</b> Assignment</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="extras.html"><a href="extras.html"><i class="fa fa-check"></i><b>11</b> Extras</a>
<ul>
<li class="chapter" data-level="11.1" data-path="extras.html"><a href="extras.html#resources-for-further-learning"><i class="fa fa-check"></i><b>11.1</b> Resources for further learning</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EBIO4100: Bioinformatics in the Mountains</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rna-seq" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Activity 10</span> RNA-seq<a href="rna-seq.html#rna-seq" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This tutorial is adapted from NYUâ€™s <a href="https://learn.gencore.bio.nyu.edu/rna-seq-analysis/aligning-rna-seq-data/">NGS Analysis site</a>.</p>
<p>We are going to try to put together everything we have learned today. Letâ€™s start by making a working directory for this project.</p>
<p><strong>1. Make folders for today, and copy your file into it. Then, start an interactive job.</strong></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<pre class="foldable"><code>cd /scratch/alpine/usrname
mkdir -p rnaseq/data rnaseq/scripts rnaseq/analyses
cp sra/*fastq.gz rnaseq/data/
cd rnaseq/scripts

sinteractive --partition=amilan -t 4:00:00</code></pre>
</details>
<div id="processing-the-data" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Processing the data<a href="rna-seq.html#processing-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="quality-control" class="section level3 hasAnchor" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Quality Control<a href="rna-seq.html#quality-control" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>2. Run quality control on the fastq files.</strong></p>
<p>To be reproducible, you can run this step in a script (optional).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<pre class="foldable"><code>module load fastqc

fastqc rnaseq/data/*fastq.gz 
</code></pre>
</details>
</div>
<div id="trimming-1" class="section level3 hasAnchor" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> Trimming<a href="rna-seq.html#trimming-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>3. Trim the reads.</strong></p>
<p>To be reproducible, you can run this step in a script (optional).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<pre class="foldable"><code>module load trimmomatic

java -jar $TRIMMOMATIC PE rnaseq/data/SRR7244680_1.fastq.gz rnaseq/data/SRR7244680_2.fastq.gz rnaseq/analyses/SRR7244680_1P.fastq.gz rnaseq/analyses/SRR7244680_1U.fastq.gz rnaseq/analyses/SRR7244680_2P.fastq.gz rnaseq/analyses/SRR7244680_2U.fastq.gz HEADCROP:10 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36

java -jar $TRIMMOMATIC PE rnaseq/data/SRR7244685_1.fastq.gz rnaseq/data/SRR7244685_2.fastq.gz rnaseq/analyses/SRR7244685_1P.fastq.gz rnaseq/analyses/SRR7244685_1U.fastq.gz rnaseq/analyses/SRR7244685_2P.fastq.gz rnaseq/analyses/SRR7244685_2U.fastq.gz HEADCROP:10 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36
</code></pre>
</details>
</div>
<div id="alignment" class="section level3 hasAnchor" number="10.1.3">
<h3><span class="header-section-number">10.1.3</span> Alignment<a href="rna-seq.html#alignment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are several popular aligners for RNA-seq, but we will use STAR because it is ready to use on the cluster. You can find the manual for STAR <a href="https://github.com/alexdobin/STAR/blob/master/doc/STARmanual.pdf">here</a>.</p>
<p>Much like BWA, you need to index the genome sequence with STAR before aligning. This <em>only needs to be done once</em>, so I have done it for you. Below is the command I used:</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<pre class="foldable"><code>STAR --runThreadN 8 --runMode genomeGenerate --genomeDir /scratch/alpine/mefr3284/ebio4100/reference --genomeFastaFiles /scratch/alpine/mefr3284/ebio4100/reference/moch.dovetail.reference.hap1.scaffolds.renamed.fasta --sjdbGTFfile /scratch/alpine/mefr3284/ebio4100/reference/PO2749_Poecile_gambeli.annotation.scaf.renamed.gff --sjdbGTFtagExonParentTranscript Parent --sjdbOverhang 150 --genomeChrBinNbits 16 --genomeSAindexNbases 12 --limitSjdbInsertNsj 300000</code></pre>
</details>
<p><strong>4. The next step will be to do the actual alignment.</strong></p>
<p>You will need to do this in a batch script, because you will need to request extra resources from the cluster. Your script might look like this:</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<pre class="foldable"><code>#!/bin/bash 

#SBATCH --nodes=1
#SBATCH --ntasks=8
#SBATCH --time=4:00:00
#SBATCH --partition=amilan 
#SBATCH --output=mapping.out
#SBATCH --qos=normal 

module load star

STAR --runThreadN 8 --genomeDir /scratch/alpine/mefr3284/ebio4100/reference --readFilesIn rnaseq/analyses/SRR7244680_1P.fastq.gz rnaseq/analyses/SRR7244680_2P.fastq.gz --outSAMtype BAM SortedByCoordinate --outFileNamePrefix rnaseq/analyses/SRR7244680 --readFilesCommand zcat

STAR --runThreadN 8 --genomeDir /scratch/alpine/mefr3284/ebio4100/reference --readFilesIn rnaseq/analyses/SRR7244685_1P.fastq.gz rnaseq/analyses/SRR7244685_2P.fastq.gz --outSAMtype BAM SortedByCoordinate --outFileNamePrefix rnaseq/analyses/SRR7244680 --readFilesCommand zcat
</code></pre>
</details>
<p>This step should take 20-30 minutes. If you request more resources, it will run faster, but it is likely to <em>queue</em> slower, taking more real time.</p>
</div>
<div id="remove-duplicates" class="section level3 hasAnchor" number="10.1.4">
<h3><span class="header-section-number">10.1.4</span> Remove duplicates<a href="rna-seq.html#remove-duplicates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>5. Use picard to remove duplicates.</strong></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<pre class="foldable"><code>module load picard 

picard MarkDuplicates -INPUT rnaseq/analyses/SRR7244680Aligned.sortedByCoord.out.bam -OUTPUT rnaseq/analyses/SRR7244680.filtered.sorted.nodup.bam -METRICS_FILE rnaseq/analyses/SRR7244680.duplicate.metrics -REMOVE_DUPLICATES true -ASSUME_SORTED true -TMP_DIR rnaseq/analyses/SRR7244680_tmp -MAX_FILE_HANDLES 1000

picard MarkDuplicates -INPUT rnaseq/analyses/SRR7244685Aligned.sortedByCoord.out.bam -OUTPUT rnaseq/analyses/SRR7244685.filtered.sorted.nodup.bam -METRICS_FILE rnaseq/analyses/SRR7244685.duplicate.metrics -REMOVE_DUPLICATES true -ASSUME_SORTED true -TMP_DIR rnaseq/analyses/SRR7244685_tmp -MAX_FILE_HANDLES 1000

module load samtools 
samtools index rnaseq/analyses/SRR7244680.filtered.sorted.nodup.bam
samtools index rnaseq/analyses/SRR7244685.filtered.sorted.nodup.bam
</code></pre>
</details>
</div>
</div>
<div id="differential-expression" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Differential expression<a href="rna-seq.html#differential-expression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this section, we will use an instance of R on the Posit Cloud. You will receive an invitation to the workspace via email.</p>
<p><strong>6. Use the Posit Cloud environment to run the Differential Expression script.</strong></p>
</div>
<div id="assignment-9" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Assignment<a href="rna-seq.html#assignment-9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will discuss.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="blast-and-genome-browser.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="extras.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": null,
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/USERNAME/REPO/edit/BRANCH/11-rnaseq.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["_main.pdf", "_main.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection",
    "scroll_highlight": true
  }
});
});
</script>

</body>

</html>
